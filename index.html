<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Летная +</title>
    <style>
        /* Стили из предыдущего варианта + дополнения */
        body {
            font-family: 'Roboto', sans-serif;
            background: #f8f9fa;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        /* Остальные стили... */
    </style>
</head>
<body>
    <div class="container">
        <h1 id="auth-name">Добро пожаловать!</h1>

        <!-- Статистика -->
        <div id="statistics">
            <h2>Статистика</h2>
            <p>Общий налет: <span id="total-time">0</span> часов</p>
            <p>Количество полетов: <span id="flight-count">0</span></p>
            <h3>Налет по месяцам</h3>
            <div id="monthly-stats"></div>
        </div>

        <!-- Поиск -->
        <div class="search-section">
            <input type="text" id="search-input" placeholder="Поиск по фамилии">
            <button onclick="performSearch()">Искать по экипажу</button>
            
            <input type="text" id="search-route" placeholder="Поиск по маршруту">
            <button onclick="performRouteSearch()">Искать по маршруту</button>
        </div>

        <!-- Форма добавления -->
        <form id="flight-form" style="display:none;">
            <div>
                <label>Дата: <input type="date" name="date" required></label>
            </div>
            <div>
                <label>Тип ВС: <input type="text" name="type" required></label>
            </div>
            <div>
                <label>Время (чч:мм): <input type="text" name="time" required></label>
            </div>
            <div class="crew-section">
                <h3>Состав экипажа</h3>
                <div class="crew-member">
                    <input type="text" name="crew" placeholder="Фамилия члена экипажа">
                </div>
                <button type="button" onclick="addCrewMember()">+ Добавить члена экипажа</button>
            </div>
            <div>
                <label>Маршрут полета: <input type="text" name="route" required></label>
            </div>
            <div>
                <label>Комментарий: <input type="text" name="comment"></label>
            </div>
            <div>
                <label>PDF файл: <input type="file" name="pdf" accept="application/pdf"></label>
            </div>
            <button type="submit">Сохранить</button>
        </form>

        <!-- Список полетов -->
        <ul id="flight-list"></ul>
    </div>

    <!-- Telegram Login ВИДЖЕТ -->
    <script async src="https://telegram.org/js/telegram-widget.js?7"
        data-telegram-login="trueletnaya_bot"
        data-size="large"
        data-userpic="false"
        data-request-access="write"
        data-onauth="onTelegramAuth(user)">
    </script>

    <script>
        // Класс для хранения информации о полете
        class Flight {
            constructor(date, type, time, crew, route, details) {
                this.date = date;
                this.type = type;
                this.time = time;
                this.crew = crew || [];
                this.route = route;
                this.details = details || {};
            }
        }

        // Telegram авторизация
        function onTelegramAuth(user) {
            const name = user.first_name + (user.last_name ? ' ' + user.